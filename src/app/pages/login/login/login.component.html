<div class="login-container">
  <div class="animated-bg"></div>

  <mat-card class="login-card">
    <div class="card-header">
      @if (true) {
        <div class="logo-container">
          <img src="assets/quiz.png" alt="QuizLab Logo" class="logo">
        </div>
      }
      <!-- <h1 class="title">QuizLab</h1> -->
      <p class="subtitle">Acesso à Plataforma</p>
    </div>

    <form [formGroup]="form" (ngSubmit)="login()" class="login-form">
      <!-- Email Field -->
      <mat-form-field appearance="outline" class="full-width" subscriptSizing="dynamic">
        <mat-label>
          <mat-icon class="input-icon">email</mat-icon>
          Email
        </mat-label>
        <input 
          matInput 
          type="email"
          formControlName="email"
          autocomplete="email"
          required>
        @if (email?.hasError('required') && email?.touched) {
          <mat-error>Email é obrigatório</mat-error>
        }
        @if (email?.hasError('email') && email?.touched) {
          <mat-error>Email inválido</mat-error>
        }
      </mat-form-field>

      <!-- Password Field -->
      <mat-form-field appearance="outline" class="full-width" subscriptSizing="dynamic">
        <mat-label>
          <mat-icon class="input-icon">lock</mat-icon>
          Senha
        </mat-label>
        <input 
          matInput 
          [type]="hidePassword() ? 'password' : 'text'"
          formControlName="password"
          autocomplete="current-password"
          required>
        <button 
          type="button"
          mat-icon-button 
          matSuffix 
          (click)="togglePasswordVisibility()"
          class="password-toggle"
          [attr.aria-label]="hidePassword() ? 'Mostrar senha' : 'Ocultar senha'">
          <mat-icon>{{ hidePassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
        @if (password?.hasError('required') && password?.touched) {
          <mat-error>Senha é obrigatória</mat-error>
        }
        @if (password?.hasError('minlength') && password?.touched) {
          <mat-error>Senha deve ter no mínimo 6 caracteres</mat-error>
        }
      </mat-form-field>

      <!-- Login Button -->
      <button 
        type="submit"
        mat-raised-button 
        color="primary" 
        class="login-button full-width"
        [disabled]="form.invalid || loading()">
        @if (loading()) {
          <mat-spinner diameter="20" class="button-spinner"></mat-spinner>
          <span>Entrando...</span>
        } @else {
          <div style="display: flex;">
            <mat-icon>login</mat-icon>
            <span>Entrar</span>
          </div>
        }
      </button>

      <!-- Divider -->
      <mat-divider class="divider-with-text">
        <span>Novo por aqui?</span>
      </mat-divider>

      <!-- Sign Up Link -->
      <button 
        type="button"
        mat-stroked-button 
        class="full-width signup-button"
        routerLink="/signup"
        [disabled]="loading()">
        <mat-icon>person_add</mat-icon>
        Criar Conta
      </button>

      <!-- Forgot Password Link -->
      <div class="forgot-password">
        <a routerLink="/forgot-password">Esqueceu sua senha?</a>
      </div>
    </form>
  </mat-card>
</div>